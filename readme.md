# 地图纠错工具原型

## 概述
（作业文本本质是markdown写的，在github网页查看可能效果更佳）  
本程序复用了本人之前的JavaFx联网画板程序（Java课程的大作业程序）的许多代码，而且UI风格一脉相承，但从底层上改变了原程序的一些逻辑，而且彻底删除了网络功能。当然，从本次作业的要求来看，重写一份仅仅符合要求的程序比改造之前的程序的成本更低，难度更小，但是我还是想实现一些更多的功能，也体现了一下之前代码的复用性，就改造了一下之前的代码，做出了这个结果。  

程序较好的完成了要求的所有功能，并在许多地方有所延伸，以下为详细内容：  
1. 地图数据加载:从应用中打开PNG栅格或mec文档（MapErrorCorrect，我自定义的文档后缀名，其实就是文本文件。该文件能储存与地图一一对应的矢量数据）格式的地图矢量数据文件，并显示在应用程序窗口中。
2. 地图数据显示:其中，栅格图像会显示在主程序中，当然，矢量也能加载到主程序中，并在主程序的GUI界面中实现对矢量数据的可视化修改。文本矢量文件亦可以由一个相对独立的，用JavaFx实现的简单记事本（MyNotePad）显示并提供编辑功能。
3. 地图数据快捷显示：当鼠标移动到矢量附近，程序的状态栏会显示矢量的备注
![图 1](https://i.loli.net/2021/04/22/oTwvHnM6brWseDf.png)  
4. 错误记录:直接用画板的形式在图像中画出并纠正错误，每次绘画的详细行为都会被记录在文本文件中。可以像画画一样纠正地图。
5. 错误记录查询:地图数据加载后，在质检工具中打开已保存的错误信息文件，可通过输入关键字搜索并显示出错情况。并且可以对搜索到的错误信息进行任意修改，包括修改位置和错误备注。
6. 矢量绘制:能自动加载与地图文件同名的矢量文件，并将其显示在图上。

## 使用指南
![图 2](https://i.loli.net/2021/04/22/NozpjAxlg86XKQC.png)  
### 功能介绍
#### 绘制功能
程序支持9种绘图工具，分别是铅笔，橡皮，打个原点，文字，直线，圆角矩形/矩形，多边形，椭圆（用这个画圆其实也可以）。上图展示了大部分绘图的特性。绘图之后程序会以文本方式将绘制的图形储存。储存的结构是**画笔属性+点位置+错误描述文本**。这里面有两种矢量的储存比较特殊。
1. **铅笔/橡皮**：这个工具就像一种画笔，能绘制任意形状的线。当然，其实底层上是以折线的形式储存的矢量。具体操作时，视鼠标的dpi和响应速度影响，画一笔可能有几十个点。比较占用空间。
2. **多边形**：如图右边中间，位置文本框显示的，多边形会储存成多个点。原理简单，效果不错。
#### 搜索&修改功能
如图，右边的搜索框里输入，某一矢量描述字符串的，一个子串，就能找到那个矢量啦。如果存在多个矢量描述包含同一子串的情况，返回第一个结果。此时时间修改描述或者位置，并点击保存更改，就能把更改同步到本地文件中，如果在文档菜单中选择文档重绘，就能看到修改位置后的图形。  
![图 4](https://i.loli.net/2021/04/22/hl8HOQLjUmAfqZt.png)  
#### 矢量文档编辑功能
在上图的选单点击文档编辑，即可调用一个记事本编辑与当前图像对应的文档，文档在编辑后的改动会被即时反馈在图上。
![图 5](https://i.loli.net/2021/04/22/qjMNogmhE9B8JsW.png)  

## 架构分析
![图 7](https://i.loli.net/2021/04/22/rWHKNfDLxyZwgdl.png)  
上图是本程序的UML类图，当然，这个.uml文件已经附在附件内，可以在idea内打开。如果用其他工具打开应该只能看到类名，看不到构造和类方法。  
我把这些类分成了4列，每列有不同的意义
1. 第一列：是JavaFx的入口类，实际意义就是把各种组件组合到一起
